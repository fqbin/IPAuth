# IPAuth - Typecho IP智能内容控制插件

## 插件简介

IPAuth是一款Typecho插件，实现基于访问者IP地址的智能内容控制。插件会无感化地检测用户IP地址，并根据配置自动显示或隐藏文章中的特定内容，整个过程对用户完全透明。

## 核心功能

### 🔍 无感化IP检测
- 自动获取访问者真实IP地址
- 支持代理环境下的IP检测（X-Forwarded-For、X-Real-IP等）
- 支持外网IP检测
- 无需用户任何操作，完全后台处理

### 🛡️ 智能内容控制
- **白名单模式**：只有授权IP才能查看受保护内容
- **黑名单模式**：授权IP无法查看受保护内容（反向控制）
- 支持完全隐藏或自定义替换内容

### 📍 灵活的IP匹配
- 支持IPv4地址
- 支持CIDR格式网段匹配（如192.168.1.0/24）
- 支持精确IP匹配
- 内网IP和外网IP双重检测

### 🎨 自定义样式
- 可自定义隐藏内容提示框的Logo
- 可自定义提示文字内容
- 可自定义背景颜色
- 可自定义主题颜色（边框、文字、图标）
- 美观的默认样式设计

## 安装方法

1. 将`IPAuth`文件夹上传到Typecho的`usr/plugins/`目录
2. 在后台插件管理中启用"IPAuth"插件
3. 进入插件设置页面进行配置

## 使用方法

### 基础语法
在文章内容中使用简码标记需要控制的内容：

```
[ipauth]这里是需要IP控制的内容[/ipauth]
```

### 使用示例

```markdown
这是普通内容，所有人都可以看到。

[ipauth]
这部分内容只有特定IP才能看到：
- 内部资料链接
- 敏感信息
[/ipauth]

这又是普通内容。
```

## 配置选项

### 授权IP列表
每行填写一个IP地址或网段，支持以下格式：

```
# IPv4地址
192.168.1.100
10.0.0.50

# CIDR网段
192.168.1.0/24
10.0.0.0/8
```

### IP控制模式
- **白名单模式**：只有在授权列表中的IP才能查看受保护内容
- **黑名单模式**：在授权列表中的IP无法查看受保护内容

### 样式自定义
- **Logo URL**：自定义提示框的图标（留空使用默认锁形图标）
- **提示文字**：自定义隐藏内容的提示信息
- **背景颜色**：提示框背景色（如：#f0f9ec）
- **主题颜色**：统一控制边框、文字和图标颜色（如：#78C841）

### 调试模式
启用后，管理员登录时会在页面右下角显示当前访问者的IP信息，便于测试和调试。

## 应用场景

1. **内网内容管控** - 只允许内网IP查看敏感信息
2. **地域内容限制** - 基于IP地址进行地域内容控制
3. **测试环境隔离** - 开发测试内容只对特定IP可见
4. **反向内容控制** - 对特定IP隐藏某些内容

## 注意事项

1. **IP获取准确性** - 在CDN或多层代理环境下，需要确保能正确获取真实IP
2. **性能考虑** - 大量IP规则可能影响页面加载速度
3. **缓存影响** - 如果启用了页面缓存，可能需要配置缓存策略

## 更新日志

### v1.0.0
- 基础IP白名单功能
- 实现无感化IP检测
- 兼容Typecho 1.0+

## 如有功能建议，请创建GitHub Issue
---

**警告**: 请仅将此插件用于合法的内容控制目的，开发者不承担因滥用插件造成的任何责任。
